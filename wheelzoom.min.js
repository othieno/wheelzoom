window.wheelzoom=function(){"use strict";function e(e){e.style.backgroundImage="url('"+e.src+"')",e.style.backgroundRepeat="no-repeat",n.width=e.naturalWidth,n.height=e.naturalHeight,e.src=n.toDataURL()}var t={zoom:.1},n=document.createElement("canvas"),o=function(n,o){function r(){f>0?f=0:m-p>f&&(f=m-p),E>0?E=0:v-g>E&&(E=v-g),n.style.backgroundSize=p+"px "+g+"px",n.style.backgroundPosition=f+"px "+E+"px"}function a(){p=m,g=v,f=E=0,r()}function u(e){var t=0;e.preventDefault(),e.deltaY?t=e.deltaY:e.wheelDelta&&(t=-e.wheelDelta);var o=n.getBoundingClientRect(),u=e.pageX-o.left-document.body.scrollLeft,d=e.pageY-o.top-document.body.scrollTop,s=u-f,c=d-E,i=s/p,l=c/g;0>t?(p+=p*w.zoom,g+=g*w.zoom):(p-=p*w.zoom,g-=g*w.zoom),f=u-p*i,E=d-g*l,m>=p||v>=g?a():(r(),n.dispatchEvent(new Event("scroll")))}function d(e){e.preventDefault(),f+=e.pageX-h.pageX,E+=e.pageY-h.pageY,h=e,r()}function s(){document.removeEventListener("mouseup",s),document.removeEventListener("mousemove",d)}function c(e){e.preventDefault(),h=e,document.addEventListener("mousemove",d),document.addEventListener("mouseup",s)}function i(){var t=window.getComputedStyle(n,null);m=parseInt(t.width,10),v=parseInt(t.height,10),p=m,g=v,f=0,E=0,e(n),n.style.backgroundSize=m+"px "+v+"px",n.style.backgroundPosition="0 0",n.addEventListener("wheelzoom.reset",a),n.addEventListener("wheel",u),n.addEventListener("mousedown",c)}function l(){n.removeEventListener("load",l),i()}if(n&&n.nodeName&&"IMG"===n.nodeName){var m,v,p,g,f,E,h,w={};n.addEventListener("wheelzoom.destroy",function(e){console.log(e),n.removeEventListener("wheelzoom.destroy"),n.removeEventListener("wheelzoom.reset",a),n.removeEventListener("load",l),n.removeEventListener("mouseup",s),n.removeEventListener("mousemove",d),n.removeEventListener("mousedown",c),n.removeEventListener("wheel",u),n.style.backgroundImage=e.backgroundImage,n.style.backgroundRepeat=e.backgroundRepeat,n.src=e.src}.bind(null,{backgroundImage:n.style.backgroundImage,backgroundRepeat:n.style.backgroundRepeat,src:n.src})),o=o||{},Object.keys(t).forEach(function(e){w[e]=void 0!==o[e]?o[e]:t[e]}),n.complete?i():n.addEventListener("load",l)}};return"function"!=typeof window.getComputedStyle?function(e){return e}:function(e,t){return e&&e.length?Array.prototype.forEach.call(e,o,t):e&&e.nodeName&&o(e,t),e}}();